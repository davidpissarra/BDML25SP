{
    "question": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 26 Jul 2024\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nThe following text is noisy and dirty, so please rephrase the following text while removing noisy text (e.g., incorrect characters coming from the pdf reader, emails, footnotes, etc.), but without removing important content or adding new data, however keep as much data as possible:\n\n\" Cambridge, MA 02138, U.S.A. ewalker@g.harvard.edu Douglas Finkbeiner Department of Physics Harvard University Cambridge, MA 02138, U.S.A. dfinkbeiner@cfa.harvard.eduCecilia Garraffo AstroAI Center for Astrophysics |Harvard & Smithsonian Cambridge, MA 02138, U.S.A. cgarraffo@cfa.harvard.edu Abstract Shadow detection and removal is a challenging problem in the analysis of hyper- spectral images. Yet, this step is crucial for analyzing data for remote sensing applications like methane detection. In this work, we develop a shadow detection and removal method only based on the spectrum of each pixel and the overall distribution of spectral values. We first introduce Iterative Logistic Regression (ILR) to learn a spectral basis in which shadows can be linearly classified. We then model the joint distribution of the mean radiance and the projection coefficients of the spectra onto the above basis as a parametric linear combination of Gaussians. We can then extract the maximum likelihood mixing parameter of the Gaussians to estimate the shadow coverage and to correct the shadowed spectra. Our correction scheme reduces correction artefacts at shadow borders. The shadow detection and removal method is applied to hyperspectral images from MethaneAIR, a precursor to the satellite MethaneSAT. 1 Introduction Methane is the second most important greenhouse gas following carbon dioxide. MethaneSAT is a satellite mission aiming to map the methane density in the atmosphere[ 1]. For this and other similar missions, careful analysis of the hyperspectral image resulting from the detector is essential to retrieve the target atmospheric components. Two significant challenges in image analysis are clouds and shadows[ 2]. In the case of MethaneSAT, a cloud essentially blocks the retrieval of methane density Tackling Climate Change with Machine Learning: workshop at NeurIPS 2023.Figure 1: Hyperspectral data from MethaneAIR. (Left) The mean radiance for all pixels. (Middle) The spectrum at each of the 3 points on the left image. (Right) The map of labels. “Sure Ground\" and “Sure Cloud\" are simple made by binary erosion of the shadow and ground labels. under it. However, depending on the indirect ground illumination, shadowed pixels might carry a detectable signal. These pixels could either be processed by a different downstream pipeline or be corrected for the effect of the shadow before entering the subsequent pipelines. In this work, we present a probabilistic latent spectral space inference method to remove the average effect of a shadow on a spectrum, while preserving the original spectral features as much as possible. This method is applied to hyperspectral images from MethaneAIR, a precursor to the MethaneSAT satellite. 2 Method Data We use hyperspectral imaging data from a MethaneAIR flight [ 2]. Our data is a set of hyperspectral images with 1024 spectral bins and varying width and height. An image with clouds and shadows within the field of view is in Fig. 1. The most evident feature of a shadow is the reduced mean radiance. To enhance the method to learn spectral shape changes by shadows, we explicitly remove the mean radiance ( mi) by dividing each spectrum by its mean and taking the logarithm. Thus each spectrum fiis normalized as si= log( fi/mi).logis the natural logarithm everywhere. Iterative Logistic Regression and Latent Basis Learning Using spectra and binary labels( si∈ R1024, yi∈[0,1]) from sunlit and shadowed pixels, we train our Iterative Logistic Regression(ILR), described in Algorithm 1. On each iteration, the best spectral weight separating shadowed pixels and bright pixels are learned by a logistic regression and projected out from the data, until the classification accuracy becomes negligible. The resulting weights( W∈ R(k,1024)) form a k-dimensional spectral basis for the latent space and the projection coefficients of each spectrum onto this basis( βi∈ Rks.t.si=βT iW+snull i) becomes the features of each spectrum in this basis. In practice the dimensionality of this space is much smaller than the number of spectral bins, in our case k= 23. Algorithm 1 Iterative Logistic Regression Require: x∈ R(n,p), y∈[0,1]n, fthres∈(0,1) ▷Dataset with n rows and p features W= []; f1= 1 while f1≥fthres do ▷Repeat until the data is hard to classify xTr, yTr, xTe, yTe=split(x, y) w=get_wLR(xTr, yTr) ▷Get the separating hyperplane from logistic regression ˆyTe=σ(xTe·w)>0.5;f1=get_f1(yTe,ˆyTe) ▷Get the predictions, σis a sigmoid x←x−x·w/||w||2 �\".<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
    "answer": "Here's the rephrased text with the noisy characters and data removed:\n\nCambridge, MA 02138, USA\nDouglas Finkbeiner\nDepartment of Physics\nHarvard University\nCambridge, MA 02138, USA\ndfinkbeiner@cfa.harvard.edu\n\nCecilia Garraffo\nAstroAI Center for Astrophysics | Harvard & Smithsonian\nCambridge, MA 02138, USA\ncgarraffo@cfa.harvard.edu\n\nAbstract:\nShadow detection and removal is a challenging problem in the analysis of hyperspectral images. This step is crucial for analyzing data for remote sensing applications like methane detection. In this work, we develop a shadow detection and removal method based solely on the spectrum of each pixel and the overall distribution of spectral values.\n\nWe first introduce Iterative Logistic Regression (ILR) to learn a spectral basis in which shadows can be linearly classified. We then model the joint distribution of the mean radiance and the projection coefficients of the spectra onto this basis as a parametric linear combination of Gaussians. We can then extract the maximum likelihood mixing parameter of the Gaussians to estimate the shadow coverage and correct the shadowed spectra. Our correction scheme reduces correction artifacts at shadow borders.\n\nThe shadow detection and removal method is applied to hyperspectral images from MethaneAIR, a precursor to the satellite MethaneSAT.\n\n1. Introduction\nMethane is the second most important greenhouse gas after carbon dioxide. MethaneSAT is a satellite mission aiming to map the methane density in the atmosphere. For this and other similar missions, careful analysis of the hyperspectral image resulting from the detector is essential to retrieve the target atmospheric components. Two significant challenges in image analysis are clouds and shadows. In the case of MethaneSAT, a cloud essentially blocks the retrieval of methane density. However, depending on the indirect ground illumination, shadowed pixels might carry a detectable signal. These pixels could either be processed by a different downstream pipeline or be corrected for the effect of the shadow before entering the subsequent pipelines.\n\nIn this work, we present a probabilistic latent spectral space inference method to remove the average effect of a shadow on a spectrum, while preserving the original spectral features as much as possible. This method is applied to hyperspectral images from MethaneAIR, a precursor to the MethaneSAT satellite.\n\n2. Method\nWe use hyperspectral imaging data from a MethaneAIR flight. Our data is a set of hyperspectral images with 1024 spectral bins and varying width and height. An image with clouds and shadows within the field of view is shown in Figure 1. The most evident feature of a shadow is the reduced mean radiance. To enhance the method to learn spectral shape changes by shadows, we explicitly remove the mean radiance by dividing each spectrum by its mean and taking the logarithm. Thus, each spectrum is normalized as si = log(fi/mi), where log is the natural logarithm.\n\nIterative Logistic Regression and Latent Basis Learning\nUsing spectra and binary labels (si ∈ R1024, yi ∈ [0,1]) from sunlit and shadowed pixels, we train our Iterative Logistic Regression (ILR), described in Algorithm 1. On each iteration, the best spectral weight separating shadowed pixels and bright pixels are learned by a logistic regression and projected out from the data, until the classification accuracy becomes negligible. The resulting weights (W ∈ R(k,1024)) form a k-dimensional spectral basis for the latent space, and the projection coefficients of each spectrum onto this basis (βi ∈ Rk, s.t. si = βiT W + snull i) become the features of each spectrum in this basis. In practice, the dimensionality of this space is much smaller than the number of spectral bins, in our case k = 23.\n\nAlgorithm 1: Iterative Logistic Regression\nRequire: x ∈ R(n,p), y ∈ [0,1]n, fthres ∈ (0,1)\nDataset with n rows and p features\nW = []\nf1 = 1\nwhile f1 ≥ fthres do\nRepeat until the data is hard to classify\nxTr, yTr, xTe, yTe = split(x, y)\nw = get_wLR(xTr, yTr)  # Get the separating hyperplane from logistic regression\nˆyTe = σ(xTe · w) > 0.5; f1 = get_f1(yTe, ˆyTe)  # Get the predictions, σ is a sigmoid\nx ← x - x · w / ||w||2"
}