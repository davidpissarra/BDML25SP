{
    "question": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 26 Jul 2024\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nThe following text is noisy and dirty, so please rephrase the following text while removing noisy text (e.g., incorrect characters coming from the pdf reader, emails, footnotes, etc.), but without removing important content or adding new data, however keep as much data as possible:\n\n\" operations. Here, we put forward a spatially aware evaluation metric and loss function based on Optimal Transport (OT). Our framework leverages partial OT and can minimize relo- cation costs in any spatial prediction problem. We showcase the advantages of OT-based evaluation over conventional metrics and further demonstrate the application of an OT loss function for improving forecasts of bike sharing demand and charging station occupancy. Thus, our framework not only aligns with operational considerations, but also signifies a step forward in refining predictions within geospatial applications. All code is available at https://github.com/mie-lab/geospatial_optimal_transport. 1 Introduction 10 100520 25 255 20 5Cost matrixSpatial loss   OT: 90 x 20 Ground truthPrediction 1 Prediction 2Spatial loss   OT: 90 x 5 Node loss   MAE: 45       Node loss   MAE: 45        (a) Standard metrics neglect spatial costs T =Ground truth C = 25 520 0525 02020 025 5020 525000100010 00100 0010 090 0 T = 000100010 00100 001090 00OT plan (b) Computation of the OT error Figure 1: Optimal transport for evaluating spatiotemporal predictions. In contrast to other metrics, our OT framework takes into account spatial distances and the related costs or emissions (a). In detail, the costs of prediction errors are quantified in terms of the required resource reallocation, based on the optimal transportation plan mapping from predictions to ground truth (b). The transport sector accounts for 20% of CO 2-emissions worldwide (Statista) and thus plays a key role in climate action. One possible avenue to reducing emissions is the adoption of on-demand services such as (autonomous) car sharing, which was shown to effectively reduce car ownership (Mishra et al., 2015; Martin and Shaheen, 2011; Liao et al., 2020). There are two main research avenues to improving on-demand transport services: Prediction (Nguyen et al., 2018), e.g., estimating the number of shared cars/bicycles that will be picked up in the next hour, and optimization, e.g., computing the most efficient way to re-distribute 1Published at Tackling Climate Change with Machine Learning workshop at ICLR 2024 bikes/cars. Importantly, good predictions only lead to a reduction of emissions if the system is optimized with respect to the predicted demand. Meanwhile, machine learning (ML) research in geographic information sciences (GIS) or trans- portation usually treats prediction as a standalone problem, ignoring its role in downstream tasks (Yan and Wang, 2022). Consider the example of forecasting bike sharing demand per hour and per station. Usually, a time series prediction model such as an LSTM is trained on the data and the prediction quality is evaluated via the mean squared error (MSE) or mean absolute percentage error (MAPE) (Hulot et al., 2018; Brahimi et al., 2022; Shin et al., 2020; Ma and Faye, 2022), since evaluating the resulting CO 2-efficiency or business costs is cumbersome. Crucially, such metrics only quantify the error per time step and station, but ignore the spatial distribution of residuals and their implications in a production setting involving relocation costs, as illustrated in Figure 1a. Critically, these costs depend on the distance between erroneous predictions and can be viewed either as a resource relocation or as auserrelocation that is necessary due to prediction errors. We propose Optimal Transport (OT) to approximate and minimize relocation costs and thereby the involved emissions. OT provides methods to measure the disparity between two (probability) distributions, which can be leveraged as an evaluation framework comparing the real and predicted spatial distribution in any spatiotemporal prediction task, such as estimating bike sharing demand, traffic congestion or charging station occupancy. Moreover, we demonstrate how the relocation costs can be directly minimized with an OT-based loss function. Our framework is based on partial OT (Guittet, 2002; Piccoli and Rossi, 2014; Maas et al., 2015) and provides important tools to researchers and industry working with spatiotemporal data to achieve actual advances in resource management and operational efficiency with ML methods. 2 Methods 2.1 Optimal transport for evaluating spatiotemporal predictions Optimal Transport dates back to 1781, when Gaspard Monge pondered on the following question: Given a pile of earth, what is the most efficient way to redistribute it to a desired shape (Monge, 1781)? Originally termed Earth Mover’s Distance (EMD) and later generalized to Optimal Transport (OT) theory (Tolstoi, 1930; Cook et al., 1998), this\".<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
    "answer": "Here's the rephrased text with the noisy characters and data removed:\n\nOur framework presents a spatially aware evaluation metric and loss function based on Optimal Transport (OT). It leverages partial OT to minimize relocation costs in any spatial prediction problem. We demonstrate the advantages of OT-based evaluation over conventional metrics and show its application in improving forecasts of bike sharing demand and charging station occupancy. Our framework aligns with operational considerations and represents a step forward in refining predictions within geospatial applications. All code is available at https://github.com/mie-lab/geospatial_optimal_transport.\n\nIntroduction:\n\nOptimal transport is a method to measure the disparity between two probability distributions, which can be used as an evaluation framework for comparing the real and predicted spatial distribution in spatiotemporal prediction tasks, such as estimating bike sharing demand, traffic congestion, or charging station occupancy. Unlike other metrics, our OT framework takes into account spatial distances and related costs or emissions.\n\nThe transport sector accounts for 20% of CO2 emissions worldwide, making it a key area for climate action. One possible way to reduce emissions is through the adoption of on-demand services, such as car sharing, which has been shown to effectively reduce car ownership. There are two main research avenues to improve on-demand transport services: prediction and optimization. Good predictions only lead to a reduction in emissions if the system is optimized with respect to the predicted demand.\n\nMachine learning research in geographic information sciences or transportation often treats prediction as a standalone problem, ignoring its role in downstream tasks. For example, forecasting bike sharing demand per hour and per station is usually done using a time series prediction model, such as an LSTM, and evaluated via mean squared error (MSE) or mean absolute percentage error (MAPE). However, these metrics only quantify the error per time step and station, ignoring the spatial distribution of residuals and their implications in a production setting involving relocation costs.\n\nWe propose using Optimal Transport to approximate and minimize relocation costs and involved emissions. Our framework is based on partial OT and provides tools to researchers and industry working with spatiotemporal data to achieve actual advances in resource management and operational efficiency with ML methods.\n\nMethods:\n\nOptimal Transport dates back to 1781, when Gaspard Monge pondered on the question of redistributing a pile of earth to a desired shape. Originally termed Earth Mover's Distance (EMD) and later generalized to Optimal Transport theory, this concept has been used in various fields, including computer science, economics, and engineering.\n\nOur OT framework is based on partial OT and provides a method to measure the disparity between two probability distributions. It can be used as an evaluation framework for comparing the real and predicted spatial distribution in spatiotemporal prediction tasks. We demonstrate the application of our framework in improving forecasts of bike sharing demand and charging station occupancy.\n\nThe relocation costs depend on the distance between erroneous predictions and can be viewed as a resource relocation or user relocation necessary due to prediction errors. Our framework provides a way to minimize these costs and involved emissions. We show that our OT-based loss function can directly minimize relocation costs, making it a useful tool for researchers and industry working with spatiotemporal data."
}