{
    "question": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 26 Jul 2024\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nThe following text is noisy and dirty, so please rephrase the following text while removing noisy text (e.g., incorrect characters coming from the pdf reader, emails, footnotes, etc.), but without removing important content or adding new data, however keep as much data as possible:\n\n\" neural networks. This paper proposes an end-to-end approach for learning uncertainty-calibrated deep learning models that directly optimizes a downstream decision-making objective with provable robustness. We also propose two con- crete applications in energy system operations, including a grid scheduling task as well as an energy storage arbitrage task. As renewable wind and solar generation increasingly proliferate and their variability penetrates the energy grid, learning uncertainty-aware predictive models becomes increasingly crucial for maintain- ing efficient and reliable grid operation. 1 I NTRODUCTION Many real-world energy systems rely on estimated or forecasted quantities for decision-making. In the electric grid, for example, operators schedule generators hours ahead of time to satisfy pre- dicted future electricity demand (Conejo & Sioshansi, 2018). Furthermore, because predictions are imperfect, grid operators benefit from knowing predictive uncertainty, which enables operators to trade off between scheduling costs and the risk of grid instability (or worse, blackouts). Especially as renewable wind and solar energy generation increase the variability of net electricity demand (i.e., total demand minus renewable generation), calibrated uncertainty estimates are vital to reliable grid operation. Likewise, grid-scale energy storage systems rely on predictions of future electricity prices to profit from price arbitrage, storing energy when electricity prices are low, and discharging when prices are high. Since energy storage helps increase utilization of low-carbon generation (de Sisternes et al., 2016), improving storage operation profitability may help reduce carbon emissions. Deep learning models have made tremendous advances across a variety of tasks, including both electricity demand and price forecasting (Bedi & Toshniwal, 2019; Lago et al., 2018). However, deep learning models are poor at estimating their own uncertainty(Guo et al., 2017; Kuleshov et al., 2018), limiting their utility for downstream decision-making. While recent works such as isotonic regression (Kuleshov et al., 2018) and conformal prediction (Shafer & V ovk, 2008) have made ad- vances in calibrating uncertainty estimates from deep learning models, such methods are generally not differentiable and not part of the training process. Furthermore, predictive models are rarely trained end-to-end with a downstream decision-making objective. Traditional approaches first train a model to predict some quantity ( e.g., electricity demand) along with an uncertainty estimate. Then, the predicted quantity and uncertainty (possibly calibrated using a post-hoc method) are used by a downstream controller, but the controller does not provide feedback to the predictive model. Be- cause the downstream objective is often asymmetric with respect to the model’s prediction error, the trained model may be suboptimal with respect to the downstream objective. In this work, we propose training uncertainty-aware deep learning models end-to-end with down- stream decision-making objectives. By including approximate calibration layers in our model during training, we remove the need for a post-hoc calibration step. This closes the loop and ensures that feedback from the downstream objective is accounted for in the training process, since not all model 1ML modelparameters  of predictive distributioncalibrated (1-)-confidence setcalibration layeractionrobust optimization Input gradienttask lossFigure 1: We propose training a machine learning model end-to-end that outputs calibrated uncer- tainties for solving a robust optimization problem to minimize a task-specific loss. errors nor uncertainty estimates will result in the same downstream cost. The end-to-end training enables the model to focus its learning capacity on minimizing error and uncertainty on outputs with the largest decision-making cost, with more leeway for outputs that have lower costs. 2 R ELATED WORK Most related to our proposed method is the idea of “task-based end-to-end model learning” intro- duced by Donti et al. (2017), which trains machine learning models in an end-to-end fashion that directly captures the ultimate task-based objective in which they are used, within the context of stochastic programming. Backpropagating gradients through a stochastic optimization problem is made possible via the implicit function theorem. However, the method proposed by Donti et al. (2017) does not train the model to estimate uncertainty and thereby does not provide any explicit robustness to uncertainty. Our proposed model improves upon this work by outputting calibrated uncertainty sets which can then be used to determine robust decisions. Various deep learning regression models that provide uncertainty estimates have been proposed, including Bayesian neural networks (Blundell et al., 2015; Gal & Ghahramani, 2016), Gaussian process regression and deep kernel learning (Rasmussen & Williams, 2005; Wilson et al., 2016; Liu et al., 2020), ensembles of models (Lakshminarayanan et al., 2017), and quantile regression (Romano et al., 2019), among other techniques. These methods typically only provide heuristic uncertainty estimates that are not necessarily well-calibrated (Nado et al., 2022).\".<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
    "answer": "Here's the rephrased text with the noisy text removed:\n\nNeural networks are proposed to learn uncertainty-calibrated deep learning models that directly optimize a downstream decision-making objective with provable robustness. Two concrete applications in energy system operations are presented, including grid scheduling and energy storage arbitrage. As renewable wind and solar generation increasingly penetrate the energy grid, learning uncertainty-aware predictive models becomes crucial for maintaining efficient and reliable grid operation.\n\nMany real-world energy systems rely on estimated or forecasted quantities for decision-making. In the electric grid, operators schedule generators hours ahead of time based on predicted future electricity demand. Predictive uncertainty is essential for grid operators to trade off between scheduling costs and the risk of grid instability. As renewable energy generation increases the variability of net electricity demand, calibrated uncertainty estimates are vital to reliable grid operation. Energy storage systems rely on predictions of future electricity prices to profit from price arbitrage, storing energy when prices are low and discharging when prices are high. Improving storage operation profitability may help reduce carbon emissions.\n\nDeep learning models have made significant advances in electricity demand and price forecasting. However, they are poor at estimating their own uncertainty, limiting their utility for downstream decision-making. Recent works have made progress in calibrating uncertainty estimates from deep learning models, but these methods are generally not differentiable and not part of the training process. Traditional approaches first train a model to predict a quantity (e.g., electricity demand) along with an uncertainty estimate, then use the predicted quantity and uncertainty in a downstream controller without providing feedback to the predictive model.\n\nIn this work, we propose training uncertainty-aware deep learning models end-to-end with downstream decision-making objectives. By including approximate calibration layers in our model during training, we remove the need for a post-hoc calibration step. This closes the loop and ensures that feedback from the downstream objective is accounted for in the training process. The end-to-end training enables the model to focus its learning capacity on minimizing error and uncertainty on outputs with the largest decision-making cost.\n\nMost related to our proposed method is the idea of \"task-based end-to-end model learning\" introduced by Donti et al. (2017), which trains machine learning models in an end-to-end fashion that directly captures the ultimate task-based objective. However, this method does not train the model to estimate uncertainty and provide explicit robustness to uncertainty. Our proposed model improves upon this work by outputting calibrated uncertainty sets that can be used to determine robust decisions.\n\nVarious deep learning regression models that provide uncertainty estimates have been proposed, including Bayesian neural networks, Gaussian process regression, and ensembles of models. These methods typically provide heuristic uncertainty estimates that are not necessarily well-calibrated."
}